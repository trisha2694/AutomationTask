pipeline {
    agent any

    stages {
        stage('Build') {
            steps {
		bat 'aws s3 cp https://github.com/trisha2694/AutomationTask/blob/main/multiregion_describe_instnaces.zip s3://hands-on-demo-bucket-source/lambda-code --recursive'
		script{
                try{
			bat 'aws lambda update-function-code --function-name  my-function --zip-file fileb://multiregion_describe_instnaces.zip'
                }
                catch(Exception e){				  
                	bat 'aws cloudformation create-stack --stack-name aws-lambda-provisioning --template-body file://LambdaProvisiong-CFT.json'
                }
		}
           }
        }
    }
}
